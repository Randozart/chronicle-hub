/* src/styles/base/responsive.css */

/* --- GLOBAL MOBILE TYPOGRAPHY (Fixing the "Zoomed In" feel) --- */
@media (max-width: 768px) {
    html {
        font-size: 14px; /* Slightly smaller base font */
    }
    
    h1, .location-text h1, .banner-title {
        font-size: 1.8rem !important; /* Cap massive headers */
    }
    
    h2, .action-box h3 {
        font-size: 1.2rem !important;
    }
    
    .storylet-container, .character-sheet, .sidebar-content-scroll {
        padding: 1.25rem !important; /* Reduce massive padding */
    }
    
    .location-header {
        padding: 1rem !important;
    }

    .main-content-wrapper, 
    .layout-column, 
    .content-area {
        width: 100% !important;
        max-width: 100vw !important;
        padding-left: 0rem !important;  
        padding-right: 0rem !important;
        margin: 0 !important;
    }

    /* Force images to fit */
    img {
        max-width: 100%;
        height: auto;
    }
    
}

/* --- TABLET (Max 1024px) --- */
@media (max-width: 1024px) {
    
    /* NEXUS: Stack Sidebar on top of Content */
    .layout-grid-nexus {
        grid-template-columns: 1fr; 
        grid-template-rows: auto 1fr;
        height: auto; 
        overflow-y: auto !important;
    }

    /* TABLETOP: Stack Visual -> Sidebar -> Content */
    .layout-grid-tabletop {
        display: flex !important; /* Switch to flex to control order easily */
        flex-direction: column;
        height: auto !important;
        overflow-y: auto !important;
    }

    /* Ensure Visual is Top */
    .tabletop-visual-col {
        order: 1;
        height: 250px;
        flex-shrink: 0;
        width: 100%;
        border-right: none;
        border-bottom: 1px solid var(--border-color);
    }

    /* Ensure Content is Middle */
    .layout-column.content-column {
        order: 2;
        width: 100% !important;
        min-width: 0 !important;
    }

    /* Sidebar Logic for Tablet/Mobile */
    .sidebar-panel {
        display: none !important; /* Hide by default on mobile/tablet */
        position: fixed !important;
        top: 0; left: 0; right: 0; bottom: 0;
        z-index: 9999;
        width: 100% !important;
        background-color: var(--bg-panel);
    }

    /* When toggled open */
    .sidebar-panel.mobile-visible {
        display: flex !important;
        flex-direction: column;
        
        /* Force full screen dimensions */
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        
        width: 100% !important;
        height: 100vh !important;
        height: 100dvh !important; /* Dynamic viewport height for mobile browsers */
        
        /* Reset any layout-specific restrictions */
        max-height: none !important; 
        transform: none !important;
        border: none !important;
        margin: 0 !important;
        
        /* Ensure background covers everything */
        background-color: var(--bg-main); 
        background-color: var(--bg-panel); /* Theme preference */
        
        overflow-y: hidden; /* Scroll handled by inner .sidebar-content-scroll */
    }
    .sidebar-panel {
        display: none; 
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        z-index: 9999;
        width: 100%;
        background-color: var(--bg-panel);
        padding: 0;
    }

    /* Specific fix for London Layout grid collapsing */
    .london-layout-container .layout-main-grid {
        display: flex;
        flex-direction: column;
        height: auto;
        overflow: visible;
        padding: 1rem;
    }

    .content-area {
        flex: 1;
        overflow-y: auto !important;
        position: relative;
        padding: 0 !important; 
    }

}

/* --- MOBILE SPECIFIC (Max 768px) --- */
@media (max-width: 768px) {

    /* --- GLOBAL TWEAKS --- */
    .container, .storylet-container {
        width: 100%;
        box-sizing: border-box;
        margin: 0 !important;
        border-left: none !important;
        border-right: none !important;
        border-radius: 0 !important;
    }

    /* --- ADMIN & EDITOR --- */
    .admin-layout, .editor-layout {
        flex-direction: column;
        height: auto;
        overflow-y: auto;
    }

    .admin-sidebar, .editor-sidebar {
        width: 100% !important;
        height: auto;
        position: static;
        flex-direction: row;
        overflow-x: auto;
        border-right: none;
        border-bottom: 1px solid var(--border-color);
    }
    
    .admin-nav ul, .editor-toolbar {
        display: flex;
        flex-wrap: nowrap;
        align-items: center;
        padding: 0.5rem;
    }

    .admin-main, .editor-main {
        height: auto;
        min-height: 500px;
    }

    .admin-split-view {
        flex-direction: column;
    }
    .admin-list-col {
        width: 100%;
        position: static;
        max-height: 300px;
        margin-bottom: 1rem;
    }

    /* --- GAMEPLAY --- */
    .storylet-main-content {
        flex-direction: column;
    }
    .storylet-image-container {
        width: 100%;
        max-width: 100%;
        margin-bottom: 1rem;
    }
    .storylet-image {
        aspect-ratio: 16/9;
    }
    
    .option-content-wrapper {
        flex-direction: column;
        align-items: center;
        text-align: center;
    }
    .option-image-container {
        width: 80px;
        margin-bottom: 0.5rem;
    }
    .tab-bar {
        display: flex;
        width: 100%;
    }
    
    .tab-btn {
        flex: 1;
        text-align: center;
        padding: 1rem 0.5rem; /* Adjust padding for touch targets */
    }

    .theme-wrapper, 
    .main-content-wrapper, 
    .layout-column, 
    .content-area,
    .hub-view,
    .event-view {
        width: 100% !important;
        max-width: 100vw !important; /* Hard stop at viewport width */
        /* overflow-x: hidden !important; Clip anything that tries to escape */
        box-sizing: border-box !important;
    }

    /* 2. RESPONSIVE LOCATION HEADER (Stacks vertically on mobile) */
    .location-header {
        flex-direction: column !important;
        align-items: center !important;
        text-align: center !important;
        gap: 1rem !important;
        width: 100% !important;
    }

    /* The "Image + Text" group inside the header */
    .location-header > div:first-child {
        flex-direction: column !important;
        gap: 0.5rem !important;
        width: 100%;
        align-items: center !important;
    }

    /* The "Market/Travel" Buttons group */
    .location-header > div:last-child {
        width: 100%;
        justify-content: center !important;
        flex-wrap: wrap !important; /* Allow buttons to wrap if names are long */
        margin-top: 0.5rem;
    }

    /* 3. RESPONSIVE TAB BAR */
    .tab-bar {
        display: flex;
        flex-wrap: wrap; /* Allow tabs to wrap if screen is tiny */
        width: 100%;
    }
    
    .tab-btn {
        flex: 1 1 auto; /* Grow to fill, but shrink if needed */
        min-width: 80px; /* Prevent crushing */
        font-size: 0.8rem;
        padding: 0.8rem 0.5rem;
    }

    /* 4. TABLETOP SPECIFICS (Your screenshot) */
    .visual-nav-buttons {
        width: 100%;
        padding: 0 1rem;
        box-sizing: border-box;
        flex-wrap: wrap; /* Allow buttons to stack if needed */
    }

    /* EDITOR MOBILE TWEAKS */
    .editor-sidebar-collapsed-text {
        writing-mode: horizontal-tb !important; /* Force Horizontal text */
        transform: none !important; /* Remove rotation */
        letter-spacing: 1px;
        font-size: 0.7rem;
    }
    
    .editor-sidebar {
        min-height: 40px; /* Ensure click target is big enough */
    }

    html {
        /* Default is usually 16px. Setting to 14px makes 1rem = 14px.
           This effectively zooms the entire UI out by ~12%. */
        font-size: 14px; 
    }
}

/* src/styles/base/responsive.css */

/* --- GLOBAL DENSITY SCALING (The "Zoom Out") --- */
@media (max-width: 768px) {
    html {
        /* Standard is 16px. Setting to 12px shrinks the entire UI by 25%.
           If this is still too big, try 11px. */
        font-size: 12px; 
    }

    /* Shrink the massive headers */
    h1, .location-text h1, .banner-title, .profile-name {
        font-size: 1.8rem !important; /* Was ~3rem */
        line-height: 1.1;
    }
    
    h2, .action-box h3 {
        font-size: 1.3rem !important;
    }

    /* Tighten the gaps */
    .container, 
    .storylet-container, 
    .main-content-wrapper,
    .admin-content-wrapper {
        padding-left: 10px !important;
        padding-right: 10px !important; 
        width: 100% !important;
        max-width: 100vw !important;
        box-sizing: border-box !important;
        margin-bottom: 6rem !important;
    }
    
    /* Ensure images don't blow out the width */
    img {
        max-width: 100%;
        height: auto;
    }
    
    .inventory-grid {
        /* Override the inline JS style with !important */
        --inv-item-width: 100% !important;
        
        /* Force a single column layout */
        display: grid !important;
        grid-template-columns: 1fr !important;
        
        /* Ensure it stays within bounds */
        width: 100% !important;
        box-sizing: border-box !important;
        gap: 1rem !important;
    }

    .inventory-item {
        width: 100% !important;
        max-width: none !important;
        box-sizing: border-box !important;
    }
    
    /* Ensure the internal image/text layout stacks or shrinks correctly */

    
    .inventory-item .item-image-container {
        width: 100%;
        /* height: 100px !important; Give image a fixed height when stacked */
        margin-bottom: 0.5rem;
    }

    
}

/* --- ADMIN SPECIFIC DENSITY --- */
@media (max-width: 900px) {
    /* Make the admin sidebar/list compact */
    .admin-list-col {
        min-height: 100px;
        max-height: 180px !important;
    }
    
    /* Allow form inputs to sit side-by-side if they fit */
    .form-row {
        display: flex;
        gap: 0.5rem !important;
    }
    
    .form-group {
        margin-bottom: 0.8rem !important;
    }
    
    /* Make inputs smaller but still tappable */
    .form-input, .form-select {
        padding: 0.4rem !important;
        font-size: 1rem !important; /* 12px based on root */
    }
}

/* --- TABLET/MOBILE LAYOUT LOGIC --- */
@media (max-width: 1024px) {
    /* Collapse Nexus Grid */
    .layout-grid-nexus {
        grid-template-columns: 1fr; 
        grid-template-rows: auto 1fr;
        height: auto; 
        overflow-y: auto;
    }

    /* Collapse Tabletop Grid */
    .layout-grid-tabletop {
        display: flex !important;
        flex-direction: column;
        height: auto !important;
        overflow-y: auto !important;
    }

    /* Visual on top */
    .tabletop-visual-col {
        order: 1;
        height: 200px; /* Reduced height */
        width: 100%;
    }

    .layout-column.content-column {
        order: 2;
    }

    /* Hide Sidebar by default (Drawer logic) */
    .sidebar-panel {
        display: none; 
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        z-index: 9999;
        width: 100%;
        background-color: var(--bg-panel);
    }

    .sidebar-panel.mobile-visible {
        display: flex !important;
    }
    
    /* Ensure collapsed sidebar text is horizontal */
    .editor-sidebar-collapsed-text {
        writing-mode: horizontal-tb !important;
        transform: none !important;
        letter-spacing: 1px;
        font-size: 0.9rem;
    }
}